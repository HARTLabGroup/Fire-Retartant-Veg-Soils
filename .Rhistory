#### Creating Community Data (Cover Estimates + Rare Species only found as richness) ####
rich
rich <- rbind(rich[,c(1,2)], cover[,c(1,4)]) ## adding the rich and cover data together, just to make sure we didn't miss any species in any plot
rich <- rich[order(rich$plot, rich$code),] ## ordering the dataframe
rich <- rich[!duplicated(rich),] ## removing duplicates (same species and same plot, but not same species different plot)
table(rich$code)
rich$plotavg <- 0
comm <- rbind(cover.sum,rich) ## creating a community dataframe that has both cover and richness
comm <- comm[order(comm$plot, comm$code),] ## ordering the community data
comm.sum <- NA
vec <- unique(comm$plot)
for(i in 1:length(vec)){
tmp <- comm[comm$plot == vec[i],]
tmp <- tmp[!duplicated(tmp$code),]
comm.sum <- rbind(comm.sum,tmp)
print(i/length(vec))
} ## removing the richness (with cover of 0) for species that were present in the cover estimates
comm.sum <- comm.sum[-1,] ## removing the first row (error)
comm.sum <- comm.sum[order(comm.sum$plot, comm.sum$code,comm.sum$plotavg),] ## ordering the data
comm.sum.long <- comm.sum ## making a second community dataframe that I can transform and use for further analysis
comm.sum <- reshape(comm.sum, idvar = "plot", timevar = "code", direction = "wide") ## reshaping the data
rownames(comm.sum) <- comm.sum$plot ## renaming rows to be PlotID
comm.sum$plot <- NULL ## removing non species column
colnames(comm.sum) <- sub("plotavg.", "", colnames(comm.sum)) ## changing column names to be species codes
PlotCov <- as.data.frame(apply(comm.sum, 1, sum, na.rm = TRUE)) ## getting the total cover per plot
colnames(PlotCov) <- "TotalPlotCover" ## renaming the column for later
SpeciesFreq <- ifelse(comm.sum[,] >= 0,1,0) ## turning into a presense (1) absence (0) dataframe
PlotRichness <- as.data.frame(apply(SpeciesFreq, 1, sum, na.rm = TRUE)) ## recalculating a richness per plot
colnames(PlotRichness) <- "richness"
SpeciesFreq <- as.data.frame(apply(SpeciesFreq, 2, sum, na.rm = TRUE)) ## getting the number of times a species occurred
colnames(SpeciesFreq) <- "SpeciesFrequency" ## renaming to be be easy to identify later
SpeciesFreq$Species <- rownames(SpeciesFreq)
rm(tmp);rm(i);rm(vec);rm(plot.avg);rm(trans.avg)
### Should sites be split in analysis? ####
## PERMANOVA
comm.sum[comm.sum == 0] <- 0.0001
comm.sum[is.na(comm.sum)] <- 0
comm.dat <- as.matrix(comm.sum) ## making a sep df to test comm. data
soils <- soils[order(soils$Field.ID),]
soils.dat <- as.matrix(soils[,c(5:16)])
rownames(soils.dat) <- soils$Field.ID
env <- env[order(env$plot),]
sites <- factor(env$site) ## the sites are not perfectly ordered so I have to use these numbers
sev <- factor(env$sev, levels = c("unburn","low","mod","high"))
trt <- factor(env$trt)
PERMANOVA.comm <- adonis2(comm.dat ~ sites+sev+trt,
permutations = 999,
method = "bray")
PERMANOVA.soil <- adonis2(soils.dat ~ sites+sev+trt,
permutations = 999,
method = "bray")
print(PERMANOVA.comm) ## differences between sites
print(PERMANOVA.soil) ## differences between sites
# Check homogeneity of dispersions (important assumption)
# This tests if variance within groups is similar
dist_matrix.comm <- vegdist(comm.dat, method = "bray")
dist_matrix.soil <- vegdist(soils.dat, method = "bray")
dispersion.comm <- betadisper(dist_matrix.comm, sites)
dispersion.soil <- betadisper(dist_matrix.soil, sites)
permutest(dispersion.comm, permutations = 999)
permutest(dispersion.soil, permutations = 999)
# Visualize dispersions
par(mfrow = c(1,2))
plot(dispersion.comm) ## sites are very different
plot(dispersion.soil) ## sites are very different
rm(PERMANOVA.comm);rm(dist_matrix.comm);rm(dispersion.comm)
rm(PERMANOVA.soil);rm(dist_matrix.soil);rm(dispersion.soil)
rm(comm.dat);rm(soils.dat);rm(trt);rm(sev);rm(sites)
#### Question 1 ####
## SOILS Data question
## How does fire retardant application influence soil nitrogen and
## phosphorous compared to unamended burned and unburned areas?
## preliminary visualizations
## looking at variation between sites, treatments, and burn severity
par(mfrow = c(1,1))
## NH4
plot(soils$NH4, col = as.factor(soils$Location), pch = 16)
plot(soils$NH4, col = as.factor(soils$Treatment), pch = 16)
plot(soils$NH4, col = as.factor(soils$Burn.Severity), pch = 16)
## seems more related to burn severity
## NO3
plot(soils$NO3, col = as.factor(soils$Location), pch = 16)
plot(soils$NO3, col = as.factor(soils$Treatment), pch = 16)
plot(soils$NO3, col = as.factor(soils$Burn.Severity), pch = 16)
## NO3 is higher in trt regardless of burn severity
## PO4
plot(soils$PO4, col = as.factor(soils$Location), pch = 16)
plot(soils$PO4, col = as.factor(soils$Treatment), pch = 16)
plot(soils$PO4, col = as.factor(soils$Burn.Severity), pch = 16)
## looks like heavily related to trt
## splitting into two different groups
quarry.soils <- soils[soils$Location == "Quarry",]
quarry.soils$Burn.Severity <- factor(quarry.soils$Burn.Severity, levels = c("Unburned", "Low", "Moderate", "High"))
quarry.soils$Treatment <- as.factor(quarry.soils$Treatment)
sc.soils <- soils[soils$Location == "Stone Canyon",]
sc.soils$Burn.Severity[sc.soils$Burn.Severity == "Fire  Line"] <- "Burned"
sc.soils$Burn.Severity <- factor(sc.soils$Burn.Severity, levels = c("Unburned", "Burned"))
sc.soils$Treatment <- as.factor(sc.soils$Treatment)
## Linear Models
## NH4
NH4.mod.q <- lm(NH4 ~ Burn.Severity*Treatment, data = quarry.soils)
summary(NH4.mod.q)
plot(residuals(NH4.mod.q))
qqnorm(residuals(NH4.mod.q), pch = 16, cex = .75, col = rgb(0,0,0,0.75))
qqline(residuals(NH4.mod.q), col = "red", lwd = 2, lty = 2) ## okay enough
NH4.mod.sc <- lm(NH4 ~ Burn.Severity*Treatment, data = sc.soils)
summary(NH4.mod.sc)
plot(residuals(NH4.mod.sc))
qqnorm(residuals(NH4.mod.sc), pch = 16, cex = .75, col = rgb(0,0,0,0.75))
qqline(residuals(NH4.mod.sc), col = "red", lwd = 2, lty = 2) ## okay enough
rm(NH4.mod.q);rm(NH4.mod.sc)
## NO3
NO3.mod.q <- lm(NO3 ~ Burn.Severity*Treatment, data = quarry.soils)
summary(NO3.mod.q)
plot(residuals(NO3.mod.q))
qqnorm(residuals(NO3.mod.q), pch = 16, cex = .75, col = rgb(0,0,0,0.75))
qqline(residuals(NO3.mod.q), col = "red", lwd = 2, lty = 2) ## okay enough
NO3.mod.sc <- lm(NO3 ~ Burn.Severity*Treatment, data = sc.soils)
summary(NO3.mod.sc)
plot(residuals(NO3.mod.sc))
qqnorm(residuals(NO3.mod.sc), pch = 16, cex = .75, col = rgb(0,0,0,0.75))
qqline(residuals(NO3.mod.sc), col = "red", lwd = 2, lty = 2) ## okay enough
rm(NO3.mod.q);rm(NO3.mod.sc)
## PO4
P.mod.q <- lm(PO4 ~ Burn.Severity*Treatment, data = quarry.soils)
summary(P.mod.q)
plot(residuals(P.mod.q))
qqnorm(residuals(P.mod.q), pch = 16, cex = .75, col = rgb(0,0,0,0.75))
qqline(residuals(P.mod.q), col = "red", lwd = 2, lty = 2) ## okay enough
P.mod.sc <- lm(PO4 ~ Burn.Severity*Treatment, data = sc.soils)
summary(P.mod.sc)
plot(residuals(P.mod.sc))
qqnorm(residuals(P.mod.sc), pch = 16, cex = .75, col = rgb(0,0,0,0.75))
qqline(residuals(P.mod.sc), col = "red", lwd = 2, lty = 2) ## okay enough
rm(P.mod.q);rm(P.mod.sc)
## supplemental analysis of additional nutrients
colnames(soils[c(5:16)])
## pH
pH.mod.q <- lm(pH ~ Burn.Severity*Treatment, data = quarry.soils)
summary(pH.mod.q)
pH.mod.sc <- lm(pH ~ Burn.Severity*Treatment, data = sc.soils)
summary(pH.mod.sc)
rm(pH.mod.q);rm(pH.mod.sc)
## Na
Na.mod.q <- lm(Na ~ Burn.Severity*Treatment, data = quarry.soils)
summary(Na.mod.q)
Na.mod.sc <- lm(Na ~ Burn.Severity*Treatment, data = sc.soils)
summary(Na.mod.sc)
rm(Na.mod.q);rm(Na.mod.sc)
## K
K.mod.q <- lm(K ~ Burn.Severity*Treatment, data = quarry.soils)
summary(K.mod.q)
K.mod.sc <- lm(K ~ Burn.Severity*Treatment, data = sc.soils)
summary(K.mod.sc)
rm(K.mod.q);rm(K.mod.sc)
## SO4
SO4.mod.q <- lm(SO4 ~ Burn.Severity*Treatment, data = quarry.soils)
summary(SO4.mod.q)
SO4.mod.sc <- lm(SO4 ~ Burn.Severity*Treatment, data = sc.soils)
summary(SO4.mod.sc)
rm(SO4.mod.q);rm(SO4.mod.sc)
## Looking into how much the nutrients vary across treatments
aggregate(quarry.soils$NH4 ~ quarry.soils$Treatment, FUN= mean)
aggregate(sc.soils$NH4 ~ sc.soils$Treatment, FUN= mean)
aggregate(quarry.soils$NO3 ~ quarry.soils$Treatment, FUN= mean) ## order of magnitude greater
aggregate(sc.soils$NO3 ~ sc.soils$Treatment, FUN= mean)
aggregate(quarry.soils$PO4 ~ quarry.soils$Treatment, FUN= mean) ## order of magnitude greater
aggregate(sc.soils$PO4 ~ sc.soils$Treatment, FUN= mean) ## two orders of magnitude greater
## consistently higher soil nutrient concentrations in the fire retardant treatments
#### Figure 1 - Soils ####
soils$Burn.Severity[soils$Burn.Severity == "Fire  Line"] <- "Burned"
soils$Burn.Severity[soils$Burn.Severity == "Burned"] <- "Low"
se <- function(x){sd(x)/sqrt(length(x))} ## creating a function for standard error
soils$plotting <- ifelse(soils$Burn.Severity == "Unburned" & soils$Treatment == "Control", "UCON",
ifelse(soils$Burn.Severity == "Unburned" & soils$Treatment == "Fire Retardant", "UFR",
ifelse(soils$Burn.Severity == "Low" & soils$Treatment == "Control", "LCON",
ifelse(soils$Burn.Severity == "Low" & soils$Treatment == "Fire Retardant", "LFR",
ifelse(soils$Burn.Severity == "Moderate" & soils$Treatment == "Control", "MCON",
ifelse(soils$Burn.Severity == "Moderate" & soils$Treatment == "Fire Retardant", "MFR",
ifelse(soils$Burn.Severity == "High" & soils$Treatment == "Control", "HCON",
ifelse(soils$Burn.Severity == "High" & soils$Treatment == "Fire Retardant", "HFR", NA))))))))
## setting figure parameters
Fig2order.sc <- c("UCON","LCON")
vec1.sc <- c(0.9,1.9)
Fig2paired.sc <- c("UFR","LFR")
vec2.sc <- c(1.1,2.1)
Fig2order.q <- c("UCON","LCON","MCON","HCON")
vec1.q <- c(0.9,1.9,2.9,3.9)
Fig2paired.q <- c("UFR","LFR","MFR","HFR")
vec2.q <- c(1.1,2.1,3.1,4.1)
SC <- soils[soils$Location == "Stone Canyon",]
Quarry <- soils[soils$Location == "Quarry",]
par(mfrow = c(3,2))
## change the nutrients of interest based on the column name in soils df
nut <- 'NH4'
plot(x = c(0.5:2.5),
y = c(0.5:2.5),
ylim = c(0,max(soils[,nut])),
las = 1,
cex.axis = 1.5,
ylab = "", ## density
type = "n",
xaxt = "n",
xlab = "") ## disturbance history
axis(1, at = c(1:2), line = 1, tick = F, labels = c("Unburned", "Low"), cex.axis = 1.5)
for(i in 1:length(Fig2order.sc)){
points(x = rep(vec1.sc[i], length(SC[,nut][SC$plotting == Fig2order.sc[i]])),
y = SC[,nut][SC$plotting == Fig2order.sc[i]],
col = rgb(0,0,0, alpha = 0.5),
pch = 19)
points(x = rep(vec2.sc[i], length(SC[,nut][SC$plotting == Fig2paired.sc[i]])),
y = SC[,nut][SC$plotting == Fig2paired.sc[i]],
col = rgb(1,0,0, alpha = 0.5),
pch = 19)
points(x = vec1.sc[i]+0.1,
y = mean(SC[,nut][SC$plotting == Fig2order.sc[i]]),
col = rgb(0,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(SC[,nut][SC$plotting == Fig2order.sc[i]])-se(SC[,nut][SC$plotting == Fig2order.sc[i]])), x0 = vec1.sc[i]+0.1,
y1 = (mean(SC[,nut][SC$plotting == Fig2order.sc[i]])+se(SC[,nut][SC$plotting == Fig2order.sc[i]])), x1 = vec1.sc[i]+0.1,
col = rgb(0,0,0),lwd = 1.5)
points(x = vec2.sc[i]+0.1,
y = mean(SC[,nut][SC$plotting == Fig2paired.sc[i]]),
col = rgb(1,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(SC[,nut][SC$plotting == Fig2paired.sc[i]])-se(SC[,nut][SC$plotting == Fig2paired.sc[i]])), x0 = vec2.sc[i]+0.1,
y1 = (mean(SC[,nut][SC$plotting == Fig2paired.sc[i]])+se(SC[,nut][SC$plotting == Fig2paired.sc[i]])), x1 = vec2.sc[i]+0.1,
col = rgb(1,0,0),lwd = 1.5)
}
plot(x = c(0.5:4.5),
y = c(0.5:4.5),
ylim = c(0,max(soils[,nut])),
las = 1,
cex.axis = 1.5,
ylab = "", ## density
type = "n",
xaxt = "n",
xlab = "") ## disturbance history
axis(1, at = c(1:4), line = 1, tick = F, labels = c("Unburned", "Low", "Moderate", "High"), cex.axis = 1.5)
for(i in 1:length(Fig2order.q)){
points(x = rep(vec1.q[i], length(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])),
y = Quarry[,nut][Quarry$plotting == Fig2order.q[i]],
col = rgb(0,0,0, alpha = 0.5),
pch = 19)
points(x = rep(vec2.q[i], length(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])),
y = Quarry[,nut][Quarry$plotting == Fig2paired.q[i]],
col = rgb(1,0,0, alpha = 0.5),
pch = 19)
points(x = vec1.q[i]+0.1,
y = mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]]),
col = rgb(0,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])-se(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])), x0 = vec1.q[i]+0.1,
y1 = (mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])+se(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])), x1 = vec1.q[i]+0.1,
col = rgb(0,0,0),lwd = 1.5)
points(x = vec2.q[i]+0.1,
y = mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]]),
col = rgb(1,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])-se(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])), x0 = vec2.q[i]+0.1,
y1 = (mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])+se(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])), x1 = vec2.q[i]+0.1,
col = rgb(1,0,0),lwd = 1.5)
}
## change the nutrients of interest based on the column name in soils df
nut <- 'NO3'
plot(x = c(0.5:2.5),
y = c(0.5:2.5),
ylim = c(0,max(soils[,nut])),
las = 1,
cex.axis = 1.5,
ylab = "", ## density
type = "n",
xaxt = "n",
xlab = "") ## disturbance history
axis(1, at = c(1:2), line = 1, tick = F, labels = c("Unburned", "Low"), cex.axis = 1.5)
for(i in 1:length(Fig2order.sc)){
points(x = rep(vec1.sc[i], length(SC[,nut][SC$plotting == Fig2order.sc[i]])),
y = SC[,nut][SC$plotting == Fig2order.sc[i]],
col = rgb(0,0,0, alpha = 0.5),
pch = 19)
points(x = rep(vec2.sc[i], length(SC[,nut][SC$plotting == Fig2paired.sc[i]])),
y = SC[,nut][SC$plotting == Fig2paired.sc[i]],
col = rgb(1,0,0, alpha = 0.5),
pch = 19)
points(x = vec1.sc[i]+0.1,
y = mean(SC[,nut][SC$plotting == Fig2order.sc[i]]),
col = rgb(0,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(SC[,nut][SC$plotting == Fig2order.sc[i]])-se(SC[,nut][SC$plotting == Fig2order.sc[i]])), x0 = vec1.sc[i]+0.1,
y1 = (mean(SC[,nut][SC$plotting == Fig2order.sc[i]])+se(SC[,nut][SC$plotting == Fig2order.sc[i]])), x1 = vec1.sc[i]+0.1,
col = rgb(0,0,0),lwd = 1.5)
points(x = vec2.sc[i]+0.1,
y = mean(SC[,nut][SC$plotting == Fig2paired.sc[i]]),
col = rgb(1,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(SC[,nut][SC$plotting == Fig2paired.sc[i]])-se(SC[,nut][SC$plotting == Fig2paired.sc[i]])), x0 = vec2.sc[i]+0.1,
y1 = (mean(SC[,nut][SC$plotting == Fig2paired.sc[i]])+se(SC[,nut][SC$plotting == Fig2paired.sc[i]])), x1 = vec2.sc[i]+0.1,
col = rgb(1,0,0),lwd = 1.5)
}
plot(x = c(0.5:4.5),
y = c(0.5:4.5),
ylim = c(0,max(soils[,nut])),
las = 1,
cex.axis = 1.5,
ylab = "", ## density
type = "n",
xaxt = "n",
xlab = "") ## disturbance history
axis(1, at = c(1:4), line = 1, tick = F, labels = c("Unburned", "Low", "Moderate", "High"), cex.axis = 1.5)
for(i in 1:length(Fig2order.q)){
points(x = rep(vec1.q[i], length(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])),
y = Quarry[,nut][Quarry$plotting == Fig2order.q[i]],
col = rgb(0,0,0, alpha = 0.5),
pch = 19)
points(x = rep(vec2.q[i], length(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])),
y = Quarry[,nut][Quarry$plotting == Fig2paired.q[i]],
col = rgb(1,0,0, alpha = 0.5),
pch = 19)
points(x = vec1.q[i]+0.1,
y = mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]]),
col = rgb(0,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])-se(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])), x0 = vec1.q[i]+0.1,
y1 = (mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])+se(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])), x1 = vec1.q[i]+0.1,
col = rgb(0,0,0),lwd = 1.5)
points(x = vec2.q[i]+0.1,
y = mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]]),
col = rgb(1,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])-se(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])), x0 = vec2.q[i]+0.1,
y1 = (mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])+se(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])), x1 = vec2.q[i]+0.1,
col = rgb(1,0,0),lwd = 1.5)
}
## change the nutrients of interest based on the column name in soils df
nut <- 'PO4'
plot(x = c(0.5:2.5),
y = c(0.5:2.5),
ylim = c(0,max(soils[,nut])),
las = 1,
cex.axis = 1.5,
ylab = "", ## density
type = "n",
xaxt = "n",
xlab = "") ## disturbance history
axis(1, at = c(1:2), line = 1, tick = F, labels = c("Unburned", "Low"), cex.axis = 1.5)
for(i in 1:length(Fig2order.sc)){
points(x = rep(vec1.sc[i], length(SC[,nut][SC$plotting == Fig2order.sc[i]])),
y = SC[,nut][SC$plotting == Fig2order.sc[i]],
col = rgb(0,0,0, alpha = 0.5),
pch = 19)
points(x = rep(vec2.sc[i], length(SC[,nut][SC$plotting == Fig2paired.sc[i]])),
y = SC[,nut][SC$plotting == Fig2paired.sc[i]],
col = rgb(1,0,0, alpha = 0.5),
pch = 19)
points(x = vec1.sc[i]+0.1,
y = mean(SC[,nut][SC$plotting == Fig2order.sc[i]]),
col = rgb(0,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(SC[,nut][SC$plotting == Fig2order.sc[i]])-se(SC[,nut][SC$plotting == Fig2order.sc[i]])), x0 = vec1.sc[i]+0.1,
y1 = (mean(SC[,nut][SC$plotting == Fig2order.sc[i]])+se(SC[,nut][SC$plotting == Fig2order.sc[i]])), x1 = vec1.sc[i]+0.1,
col = rgb(0,0,0),lwd = 1.5)
points(x = vec2.sc[i]+0.1,
y = mean(SC[,nut][SC$plotting == Fig2paired.sc[i]]),
col = rgb(1,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(SC[,nut][SC$plotting == Fig2paired.sc[i]])-se(SC[,nut][SC$plotting == Fig2paired.sc[i]])), x0 = vec2.sc[i]+0.1,
y1 = (mean(SC[,nut][SC$plotting == Fig2paired.sc[i]])+se(SC[,nut][SC$plotting == Fig2paired.sc[i]])), x1 = vec2.sc[i]+0.1,
col = rgb(1,0,0),lwd = 1.5)
}
plot(x = c(0.5:4.5),
y = c(0.5:4.5),
ylim = c(0,max(soils[,nut])),
las = 1,
cex.axis = 1.5,
ylab = "", ## density
type = "n",
xaxt = "n",
xlab = "") ## disturbance history
axis(1, at = c(1:4), line = 1, tick = F, labels = c("Unburned", "Low", "Moderate", "High"), cex.axis = 1.5)
for(i in 1:length(Fig2order.q)){
points(x = rep(vec1.q[i], length(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])),
y = Quarry[,nut][Quarry$plotting == Fig2order.q[i]],
col = rgb(0,0,0, alpha = 0.5),
pch = 19)
points(x = rep(vec2.q[i], length(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])),
y = Quarry[,nut][Quarry$plotting == Fig2paired.q[i]],
col = rgb(1,0,0, alpha = 0.5),
pch = 19)
points(x = vec1.q[i]+0.1,
y = mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]]),
col = rgb(0,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])-se(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])), x0 = vec1.q[i]+0.1,
y1 = (mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])+se(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])), x1 = vec1.q[i]+0.1,
col = rgb(0,0,0),lwd = 1.5)
points(x = vec2.q[i]+0.1,
y = mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]]),
col = rgb(1,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])-se(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])), x0 = vec2.q[i]+0.1,
y1 = (mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])+se(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])), x1 = vec2.q[i]+0.1,
col = rgb(1,0,0),lwd = 1.5)
}
#### Management Brief Soils Figure ####
par(mfrow = c(2,2))
#### Management Brief Soils Figure ####
par(mfrow = c(2,2))
nut <- "NH4"
plot(x = c(0.5:4.5),
y = c(0.5:4.5),
ylim = c(0,max(Quarry[,nut])),
las = 1,
cex.axis = 1.5,
ylab = "", ## density
type = "n",
xaxt = "n",
xlab = "") ## disturbance history
axis(1, at = c(1:4), line = 1, tick = F, labels = c("Unburned", "Low", "Moderate", "High"), cex.axis = 1.5)
for(i in 1:length(Fig2order.q)){
points(x = rep(vec1.q[i], length(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])),
y = Quarry[,nut][Quarry$plotting == Fig2order.q[i]],
col = rgb(0,0,0, alpha = 0.5),
pch = 19)
points(x = rep(vec2.q[i], length(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])),
y = Quarry[,nut][Quarry$plotting == Fig2paired.q[i]],
col = rgb(1,0,0, alpha = 0.5),
pch = 19)
points(x = vec1.q[i]+0.1,
y = mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]]),
col = rgb(0,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])-se(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])), x0 = vec1.q[i]+0.1,
y1 = (mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])+se(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])), x1 = vec1.q[i]+0.1,
col = rgb(0,0,0),lwd = 1.5)
points(x = vec2.q[i]+0.1,
y = mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]]),
col = rgb(1,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])-se(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])), x0 = vec2.q[i]+0.1,
y1 = (mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])+se(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])), x1 = vec2.q[i]+0.1,
col = rgb(1,0,0),lwd = 1.5)
}
nut <- "NO3"
plot(x = c(0.5:4.5),
y = c(0.5:4.5),
ylim = c(0,max(Quarry[,nut])),
las = 1,
cex.axis = 1.5,
ylab = "", ## density
type = "n",
xaxt = "n",
xlab = "") ## disturbance history
axis(1, at = c(1:4), line = 1, tick = F, labels = c("Unburned", "Low", "Moderate", "High"), cex.axis = 1.5)
for(i in 1:length(Fig2order.q)){
points(x = rep(vec1.q[i], length(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])),
y = Quarry[,nut][Quarry$plotting == Fig2order.q[i]],
col = rgb(0,0,0, alpha = 0.5),
pch = 19)
points(x = rep(vec2.q[i], length(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])),
y = Quarry[,nut][Quarry$plotting == Fig2paired.q[i]],
col = rgb(1,0,0, alpha = 0.5),
pch = 19)
points(x = vec1.q[i]+0.1,
y = mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]]),
col = rgb(0,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])-se(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])), x0 = vec1.q[i]+0.1,
y1 = (mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])+se(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])), x1 = vec1.q[i]+0.1,
col = rgb(0,0,0),lwd = 1.5)
points(x = vec2.q[i]+0.1,
y = mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]]),
col = rgb(1,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])-se(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])), x0 = vec2.q[i]+0.1,
y1 = (mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])+se(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])), x1 = vec2.q[i]+0.1,
col = rgb(1,0,0),lwd = 1.5)
}
nut <- "PO4"
plot(x = c(0.5:4.5),
y = c(0.5:4.5),
ylim = c(0,max(Quarry[,nut])),
las = 1,
cex.axis = 1.5,
ylab = "", ## density
type = "n",
xaxt = "n",
xlab = "") ## disturbance history
axis(1, at = c(1:4), line = 1, tick = F, labels = c("Unburned", "Low", "Moderate", "High"), cex.axis = 1.5)
for(i in 1:length(Fig2order.q)){
points(x = rep(vec1.q[i], length(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])),
y = Quarry[,nut][Quarry$plotting == Fig2order.q[i]],
col = rgb(0,0,0, alpha = 0.5),
pch = 19)
points(x = rep(vec2.q[i], length(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])),
y = Quarry[,nut][Quarry$plotting == Fig2paired.q[i]],
col = rgb(1,0,0, alpha = 0.5),
pch = 19)
points(x = vec1.q[i]+0.1,
y = mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]]),
col = rgb(0,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])-se(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])), x0 = vec1.q[i]+0.1,
y1 = (mean(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])+se(Quarry[,nut][Quarry$plotting == Fig2order.q[i]])), x1 = vec1.q[i]+0.1,
col = rgb(0,0,0),lwd = 1.5)
points(x = vec2.q[i]+0.1,
y = mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]]),
col = rgb(1,0,0, alpha = 0.5),
pch = 17)
segments(y0 = (mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])-se(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])), x0 = vec2.q[i]+0.1,
y1 = (mean(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])+se(Quarry[,nut][Quarry$plotting == Fig2paired.q[i]])), x1 = vec2.q[i]+0.1,
col = rgb(1,0,0),lwd = 1.5)
}
